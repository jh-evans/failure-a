package org.apache.commons.use.two;

import org.apache.commons.failure.*;
import org.apache.commons.lang3.tuple.*;
import java.lang.Math;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Main {
	
	public Success<ImmutablePair<String, String>> retrieveTwo() {
		
		if(Math.random() < 0.5) {			
			ImmutablePair<String, String> pair = new ImmutablePair<String, String>("Hello", "");
			Success<ImmutablePair<String, String>> result = new Success<ImmutablePair<String, String>>(pair);

			return result;
		} else {			
			ImmutablePair<String, String> pair = new ImmutablePair<String, String>("Hello", "world");
			Success<ImmutablePair<String, String>> result = new Success<ImmutablePair<String, String>>(pair);

			return result;
		}
	}

	public static void main(String[] args) {
		Main m = new Main();

		Success<ImmutablePair<String, String>> pair = m.retrieveTwo();
		
		if(pair.eval()) {
			System.out.println("Success, result is: " + pair.unwrap());
		} else {
			switch(pair) {
    			case FailureValue<ImmutablePair<String, String>> fv -> System.out.println("Failed with fv " + fv.getValue());
	    		case FailureException<ImmutablePair<String, String>> fe -> System.out.println("Failed with fe " + fe.getException());
		    	default -> System.out.println("As written, cannot happen");
			}
		}
		
		/*
		idx = m.parse(null);
		if(idx.eval()) {
			System.out.println(idx.unwrap());
		} else {
			switch(idx) {
			    case FailureValue<Number> fv -> System.out.println("Failed with fv " + fv.getValue());
			    case FailureException<Number> fe -> System.out.println("Failed with fe " + fe.getException());
			    default -> System.out.println("As written, cannot happen");
			}
		}
		
		idx = m.parse("not there");
		if(idx.eval()) {
			System.out.println(idx.unwrap());
		} else {
			switch(idx) {
			    case FailureValue<Number> fv -> System.out.println("Failed with fv " + fv.getValue());
			    case FailureException<Number> fe -> System.out.println("Failed with fe " + fe.getException());
			    default -> System.out.println("As written, cannot happen");
			}
		}
		*/
	}
}
